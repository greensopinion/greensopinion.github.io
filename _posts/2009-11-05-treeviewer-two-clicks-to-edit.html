---
layout: post
title: 'TreeViewer: Two Clicks To Edit'
date: '2009-11-05T09:06:00.000-08:00'
author: David Green
tags:
- Eclipse
- UI
modified_time: '2009-11-05T09:16:14.414-08:00'
blogger_id: tag:blogger.com,1999:blog-1482979278030787271.post-9085719594655362661
original_url: http://greensopinion.blogspot.com/2009/11/treeviewer-two-clicks-to-edit.html
comments: true
---

<p>TreeViewer is the foundation behind most trees and tree tables found in Eclipse.  It provides excellent extensibility and options for customization.  One feature, in-place editing of tree nodes, is very useful -- however the default implementation activates editing on the first click.  This can be frustrating and unintuitive to users who expect the first click to select a node, and the second click to edit.  This tip shows a simple way to cause TreeViewer to require two clicks to edit.</p><p>Since Eclipse 3.3, <code>ColumnViewerEditorActivationStrategy</code> has been available as API to configure how a TreeViewer starts editing.  Our strategy will require the tree's current selection to be the node being clicked in order for a click to be considered an editing event.  We do this by extending ColumnViewerEditorActivationStrategy as follows:</p><pre><code><br />/**<br /> * an activation strategy that only allows editor activation if the item under the<br /> * event was already selected. This has the effect of requiring a click to first select<br /> * the item, then a second click to edit. <br /> */<br />class SecondClickColumnViewerEditorActivationStrategy extends<br />  ColumnViewerEditorActivationStrategy implements ISelectionChangedListener {<br /><br /> private Object selectedElement;<br /><br /> public SecondClickColumnViewerEditorActivationStrategy(ColumnViewer viewer) {<br />  super(viewer);<br />  viewer.addSelectionChangedListener(this);<br /> }<br /> <br /> @Override<br /> protected boolean isEditorActivationEvent(<br />   ColumnViewerEditorActivationEvent event) {<br />  IStructuredSelection selection = (IStructuredSelection)getViewer().getSelection();<br />  <br />  return selection.size() == 1 && super.isEditorActivationEvent(event) && <br />    selectedElement == selection.getFirstElement();<br /> }<br /><br /> public void selectionChanged(SelectionChangedEvent event) {<br />  IStructuredSelection ss = (IStructuredSelection) event.getSelection();<br />  <br />  if (ss.size() == 1) {<br />   selectedElement = ss.getFirstElement();<br />   return;<br />  }<br /> <br />  selectedElement = null;<br /> }<br /><br />}<br /><br /></code></pre><p>This code relies on the order of events when comparing the tree's current selection against it's previous current selection.</p><p>Now all we have to do is install the strategy on our TreeViewer:</p><pre><code><br />viewer = new org.eclipse.jface.viewers.TreeViewer(parent, <br />   SWT.MULTI | SWT.H_SCROLL | SWT.V_SCROLL | SWT.FULL_SELECTION);<br />TreeViewerEditor.create(viewer,null,new SecondClickColumnViewerEditorActivationStrategy(viewer),<br />   ColumnViewerEditor.DEFAULT);  <br /></code></pre><p>Voila!  We're done: our TreeViewer now edits on the second click instead of the first.</p>
